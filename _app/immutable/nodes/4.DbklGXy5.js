import{s as ue,l as A,a as L,e as P,g as N,c as S,b as M,m as W,f as _,o as V,i as k,h as U,p as B,q as pe,k as _e,r as Q,t as z,d as H,j as X,u as ce,n as ge}from"../chunks/scheduler.CiY16n3P.js";import{S as he,i as ve,b as G,c as Z,a as x,m as ee,t as te,d as le,e as ie}from"../chunks/index.DNYLjpUt.js";import{e as ne}from"../chunks/each.B8sSIOQY.js";import{i as R}from"../chunks/data.CNihxOOj.js";import{D as be,I as q}from"../chunks/dialog.BCQVVs5j.js";import{C as se}from"../chunks/item.c_xQnBEy.js";import{G as Ie}from"../chunks/grid.BJxsHOt1.js";function oe(i){const t=q.get(i[2]);i[20]=t}function ae(i,t,l){const s=i.slice();return s[20]=t[l],s[22]=l,s}function fe(i){let t,l,s=i[20].name.toUpperCase()+"",r,o,a=i[20].ability+"",b,C;return{c(){t=P("div"),l=P("aside"),r=z(s),o=L(),b=z(a),C=L(),this.h()},l(d){t=S(d,"DIV",{class:!0});var f=M(t);l=S(f,"ASIDE",{class:!0});var y=M(l);r=H(y,s),y.forEach(_),o=N(f),b=H(f,a),C=N(f),f.forEach(_),this.h()},h(){V(l,"class","small"),V(t,"class","flex-col")},m(d,f){k(d,t,f),U(t,l),U(l,r),U(t,o),U(t,b),U(t,C)},p(d,f){f&64&&s!==(s=d[20].name.toUpperCase()+"")&&X(r,s),f&64&&a!==(a=d[20].ability+"")&&X(b,a)},d(d){d&&_(t)}}}function re(i){let t,l=i[20].ability&&fe(i);return{c(){l&&l.c(),t=Q()},l(s){l&&l.l(s),t=Q()},m(s,r){l&&l.m(s,r),k(s,t,r)},p(s,r){s[20].ability?l?l.p(s,r):(l=fe(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&_(t),l&&l.d(s)}}}function me(i){var r;let t,l=((r=i[20])==null?void 0:r.stats)+"",s;return{c(){t=P("p"),s=z(l)},l(o){t=S(o,"P",{});var a=M(t);s=H(a,l),a.forEach(_)},m(o,a){k(o,t,a),U(t,s)},p(o,a){var b;a&4&&l!==(l=((b=o[20])==null?void 0:b.stats)+"")&&X(s,l)},d(o){o&&_(t)}}}function de(i){let t,l="USED",s,r;return{c(){t=P("button"),t.textContent=l},l(o){t=S(o,"BUTTON",{"data-svelte-h":!0}),W(t)!=="svelte-axtjso"&&(t.textContent=l)},m(o,a){k(o,t,a),s||(r=ce(t,"click",i[10]),s=!0)},p:ge,d(o){o&&_(t),s=!1,r()}}}function ke(i){var p,v,c,m,I;oe(i);let t,l=((p=i[20])==null?void 0:p.name)+"",s,r,o,a=((v=i[20])==null?void 0:v.description)+"",b,C,d,f=((c=i[20])==null?void 0:c.ability)+"",y,$,D,O,E,w="DROP",u,j,h=((m=i[20])==null?void 0:m.stats)&&me(i),e=((I=i[20])==null?void 0:I.singleUse)&&de(i);return{c(){t=P("h2"),s=z(l),r=L(),o=P("p"),b=z(a),C=L(),d=P("p"),y=z(f),$=L(),h&&h.c(),D=L(),e&&e.c(),O=L(),E=P("button"),E.textContent=w},l(n){t=S(n,"H2",{});var g=M(t);s=H(g,l),g.forEach(_),r=N(n),o=S(n,"P",{});var T=M(o);b=H(T,a),T.forEach(_),C=N(n),d=S(n,"P",{});var Y=M(d);y=H(Y,f),Y.forEach(_),$=N(n),h&&h.l(n),D=N(n),e&&e.l(n),O=N(n),E=S(n,"BUTTON",{"data-svelte-h":!0}),W(E)!=="svelte-q1zyjc"&&(E.textContent=w)},m(n,g){k(n,t,g),U(t,s),k(n,r,g),k(n,o,g),U(o,b),k(n,C,g),k(n,d,g),U(d,y),k(n,$,g),h&&h.m(n,g),k(n,D,g),e&&e.m(n,g),k(n,O,g),k(n,E,g),u||(j=ce(E,"click",i[10]),u=!0)},p(n,g){var T,Y,F,J,K;oe(n),g&4&&l!==(l=((T=n[20])==null?void 0:T.name)+"")&&X(s,l),g&4&&a!==(a=((Y=n[20])==null?void 0:Y.description)+"")&&X(b,a),g&4&&f!==(f=((F=n[20])==null?void 0:F.ability)+"")&&X(y,f),(J=n[20])!=null&&J.stats?h?h.p(n,g):(h=me(n),h.c(),h.m(D.parentNode,D)):h&&(h.d(1),h=null),(K=n[20])!=null&&K.singleUse?e?e.p(n,g):(e=de(n),e.c(),e.m(O.parentNode,O)):e&&(e.d(1),e=null)},d(n){n&&(_(t),_(r),_(o),_(C),_(d),_($),_(D),_(O),_(E)),h&&h.d(n),e&&e.d(n),u=!1,j()}}}function Ce(i){let t,l,s,r,o,a,b="Abilities",C,d,f,y,$;function D(e){i[12](e)}function O(e){i[13](e)}let E={columns:i[7],rows:i[8],movingItemId:i[4],movingOffset:i[5]};i[3]!==void 0&&(E.grid=i[3]),i[0]!==void 0&&(E.items=i[0]),t=new Ie({props:E}),A.push(()=>G(t,"grid",D)),A.push(()=>G(t,"items",O)),t.$on("pointerdown",i[9]),t.$on("click",i[11]);let w=ne(i[6]),u=[];for(let e=0;e<w.length;e+=1)u[e]=re(ae(i,w,e));function j(e){i[14](e)}let h={$$slots:{default:[ke]},$$scope:{ctx:i}};return i[1]!==void 0&&(h.dialog=i[1]),f=new be({props:h}),A.push(()=>G(f,"dialog",j)),{c(){Z(t.$$.fragment),r=L(),o=P("div"),a=P("h2"),a.textContent=b,C=L();for(let e=0;e<u.length;e+=1)u[e].c();d=L(),Z(f.$$.fragment),this.h()},l(e){x(t.$$.fragment,e),r=N(e),o=S(e,"DIV",{class:!0});var p=M(o);a=S(p,"H2",{"data-svelte-h":!0}),W(a)!=="svelte-z9mrgo"&&(a.textContent=b),C=N(p);for(let v=0;v<u.length;v+=1)u[v].l(p);p.forEach(_),d=N(e),x(f.$$.fragment,e),this.h()},h(){V(o,"class","flex-col gap-1")},m(e,p){ee(t,e,p),k(e,r,p),k(e,o,p),U(o,a),U(o,C);for(let v=0;v<u.length;v+=1)u[v]&&u[v].m(o,null);k(e,d,p),ee(f,e,p),$=!0},p(e,[p]){const v={};if(p&16&&(v.movingItemId=e[4]),p&32&&(v.movingOffset=e[5]),!l&&p&8&&(l=!0,v.grid=e[3],B(()=>l=!1)),!s&&p&1&&(s=!0,v.items=e[0],B(()=>s=!1)),t.$set(v),p&64){w=ne(e[6]);let m;for(m=0;m<w.length;m+=1){const I=ae(e,w,m);u[m]?u[m].p(I,p):(u[m]=re(I),u[m].c(),u[m].m(o,null))}for(;m<u.length;m+=1)u[m].d(1);u.length=w.length}const c={};p&8388612&&(c.$$scope={dirty:p,ctx:e}),!y&&p&2&&(y=!0,c.dialog=e[1],B(()=>y=!1)),f.$set(c)},i(e){$||(te(t.$$.fragment,e),te(f.$$.fragment,e),$=!0)},o(e){le(t.$$.fragment,e),le(f.$$.fragment,e),$=!1},d(e){e&&(_(r),_(o),_(d)),ie(t,e),pe(u,e),ie(f,e)}}}function ye(i,t,l){let s,r;_e(i,R,c=>l(0,r=c));let o,a=-1;const b=q.columns,C=q.rows;let d,f,y={x:0,y:0},$={x:0,y:0},D=[0,0];const O=c=>{const m=c.detail,I=u(m);l(4,f=q.findItemId(I));const n=q.get(f);n&&(D=se.sub(I,n.anchor)),y={x:m.clientX,y:m.clientY},l(5,$={x:0,y:0}),document.addEventListener("pointermove",E),document.addEventListener("pointerup",w)},E=c=>{const m={x:c.clientX,y:c.clientY};l(5,$={x:m.x-y.x,y:m.y-y.y})},w=c=>{const m=q.get(f);if(m){const I=u(c),n=se.sub(I,D);q.canDrop(m,n)&&R.update(g=>g.map(T=>T._id==f?{...T,anchor:n}:T))}l(4,f=-1),document.removeEventListener("pointermove",E),document.removeEventListener("pointerup",w)},u=c=>{const m={x:c.clientX-d.offsetLeft,y:c.clientY-d.offsetTop},I={x:d.clientWidth/b,y:d.clientHeight/C};return[Math.floor(m.x/I.x),Math.floor(m.y/I.y)]},j=()=>{q.remove(a),l(2,a=-1),o.close()},h=c=>{const m=c.detail,I=u(m);l(2,a=q.findItemId(I)),a>-1&&o.showModal()};function e(c){d=c,l(3,d)}function p(c){r=c,R.set(r)}function v(c){o=c,l(1,o)}return i.$$.update=()=>{i.$$.dirty&1&&l(6,s=r.filter((c,m)=>r.findIndex(I=>c.key===I.key)==m))},[r,o,a,d,f,$,s,b,C,O,j,h,e,p,v]}class Ne extends he{constructor(t){super(),ve(this,t,ye,Ce,ue,{})}}export{Ne as component};
